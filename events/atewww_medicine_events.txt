namespace = ATE_WWW_MEDICINE

character_event = {
	#using an event instead of random_list because it has better randomness
	id = ATE_WWW_MEDICINE.100
	hide_window = yes
	
	is_triggered_only = yes

	option = {
		random_artifact = {
			limit = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_antibiotics
					has_artifact_flag = atewww_pills_antivirals
					has_artifact_flag = atewww_pills_vitamins
					has_artifact_flag = atewww_pills_viagra
					has_artifact_flag = atewww_pills_antidepressants
					has_artifact_flag = atewww_pills_painkillers
					has_artifact_flag = atewww_pills_sugar
				}
			}
			set_artifact_flag = atewww_pills_antibiotics
		}
		ai_chance = {
			factor = 20
		}
	}

	option = {
		random_artifact = {
			limit = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_antibiotics
					has_artifact_flag = atewww_pills_antivirals
					has_artifact_flag = atewww_pills_vitamins
					has_artifact_flag = atewww_pills_viagra
					has_artifact_flag = atewww_pills_antidepressants
					has_artifact_flag = atewww_pills_painkillers
					has_artifact_flag = atewww_pills_sugar
				}
			}
			set_artifact_flag = atewww_pills_antivirals
		}
		ai_chance = {
			factor = 8
		}
	}

	option = {
		random_artifact = {
			limit = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_antibiotics
					has_artifact_flag = atewww_pills_antivirals
					has_artifact_flag = atewww_pills_vitamins
					has_artifact_flag = atewww_pills_viagra
					has_artifact_flag = atewww_pills_antidepressants
					has_artifact_flag = atewww_pills_painkillers
					has_artifact_flag = atewww_pills_sugar
				}
			}
			set_artifact_flag = atewww_pills_antidepressants
		}
		ai_chance = {
			factor = 10
		}
	}

	
	option = {
		random_artifact = {
			limit = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_antibiotics
					has_artifact_flag = atewww_pills_antivirals
					has_artifact_flag = atewww_pills_vitamins
					has_artifact_flag = atewww_pills_viagra
					has_artifact_flag = atewww_pills_antidepressants
					has_artifact_flag = atewww_pills_painkillers
					has_artifact_flag = atewww_pills_sugar
				}
			}
			set_artifact_flag = atewww_pills_painkillers
		}
		ai_chance = {
			factor = 21
		}
	}

	option = {
		random_artifact = {
			limit = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_antibiotics
					has_artifact_flag = atewww_pills_antivirals
					has_artifact_flag = atewww_pills_vitamins
					has_artifact_flag = atewww_pills_viagra
					has_artifact_flag = atewww_pills_antidepressants
					has_artifact_flag = atewww_pills_painkillers
					has_artifact_flag = atewww_pills_sugar
				}
			}
			set_artifact_flag = atewww_pills_vitamins
		}
		ai_chance = {
			factor = 21
		}
	}

	option = {
		random_artifact = {
			limit = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_antibiotics
					has_artifact_flag = atewww_pills_antivirals
					has_artifact_flag = atewww_pills_vitamins
					has_artifact_flag = atewww_pills_viagra
					has_artifact_flag = atewww_pills_antidepressants
					has_artifact_flag = atewww_pills_painkillers
					has_artifact_flag = atewww_pills_sugar
				}
			}
			set_artifact_flag = atewww_pills_viagra
		}
		ai_chance = {
			factor = 5
		}
	}

	option = {
		random_artifact = {
			limit = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_antibiotics
					has_artifact_flag = atewww_pills_antivirals
					has_artifact_flag = atewww_pills_vitamins
					has_artifact_flag = atewww_pills_viagra
					has_artifact_flag = atewww_pills_antidepressants
					has_artifact_flag = atewww_pills_painkillers
					has_artifact_flag = atewww_pills_sugar
				}
			}
			set_artifact_flag = atewww_pills_sugar
		}
		ai_chance = {
			factor = 15
		}
	}
}


# atewww_pills_antibiotics - cures has_tuberculosis, has_typhoid_fever, has_typhus, has_bubonic_plague, syphilitic, dysentery, food_poisoning, pneumonic, 75% chance to treat ill
# atewww_pills_antivirals - cures has_measles, has_small_pox, has_aztec_disease, flu, rabies, 25% chance to treat ill
# atewww_pills_vitamins - health boost, cures scurvy
# atewww_pills_viagra - large fertility boost for a short time ( ?° ?? ?°)
# atewww_pills_antidepressants - cures stressed, depressed, lunatic, possessed
# atewww_pills_painkillers - large health boost for duration of disease
# atewww_pills_sugar - does nothing, medicine has expired/it's something useless, artifact gets destroyed

# Identify menu
character_event = {
	id = ATE_WWW_MEDICINE.1
	desc = EVTDESC_ATE_WWW_MEDICINE_1
	picture = GFX_evt_court_physician
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		random_courtier_or_vassal = {
			limit = {
				prisoner = no
				is_incapable = no
				has_minor_title = title_court_physician
			}
			save_event_target_as = court_physician
		}
		#first determine what the pills actually are
		any_artifact = {
			limit = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_antibiotics
					has_artifact_flag = atewww_pills_antivirals
					has_artifact_flag = atewww_pills_vitamins
					has_artifact_flag = atewww_pills_viagra
					has_artifact_flag = atewww_pills_antidepressants
					has_artifact_flag = atewww_pills_painkillers
					has_artifact_flag = atewww_pills_sugar
				}
			}
			ROOT = { character_event = { id =  ATE_WWW_MEDICINE.100 } }
		}
	}

	#Identify the pill yourself first
	option = {
		name = EVTOPTA_ATE_WWW_MEDICINE_1
		tooltip_info = learning
		trigger = {
			OR = {
				is_learned_trigger = yes
				learning = 12
			}
			any_artifact = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_identified_as_antibiotics
					has_artifact_flag = atewww_pills_identified_as_antivirals
					has_artifact_flag = atewww_pills_identified_as_vitamins
					has_artifact_flag = atewww_pills_identified_as_viagra
					has_artifact_flag = atewww_pills_identified_as_antidepressants
					has_artifact_flag = atewww_pills_identified_as_painkillers
					has_artifact_flag = atewww_pills_identified_as_sugar
					has_artifact_flag = atewww_pills_cannot_be_identified
				}
			}
		}
		hidden_tooltip = {
			random_list = {
				60 = { #The pill is identified correctly
					modifier = {
						factor = 1.2
						is_smart_trigger = yes
					}
					modifier = {
						factor = 1.4
						trait = physician
					}
					modifier = {
						factor = 1.4
						trait = scholar
					}
					modifier = {
						factor = 1.2
						learning = 25
					}
					modifier = {
						factor = 1.2
						learning = 20
					}
					modifier = {
						factor = 1.2
						learning = 15
					}
					modifier = {
						factor = 1.2
						learning = 10
					}
					modifier = {
						factor = 0.8
						NOT = { learning = 10 }
					}
					modifier = {
						factor = 0.8
						is_dumb_trigger = yes
					}
					modifier = {
						factor = 1.2
						physician_good_trigger = yes
					}
					set_character_flag = medicine_identification_success
				}
				40 = { #The pill is not identified correctly
					modifier = {
						factor = 0.8
						is_smart_trigger = yes
					}
					modifier = {
						factor = 0.8
						learning = 25
					}
					modifier = {
						factor = 0.8
						learning = 20
					}
					modifier = {
						factor = 0.8
						learning = 15
					}
					modifier = {
						factor = 0.8
						learning = 10
					}
					modifier = {
						factor = 1.2
						NOT = { learning = 10 }
					}
					modifier = {
						factor = 1.2
						is_dumb_trigger = yes
					}
					modifier = {
						factor = 1.2
						physician_bad_trigger = yes
					}
					random_list = {
						80 = { #No idea what it does
							modifier = {
								factor = 1.2
								is_smart_trigger = yes
							}
							modifier = {
								factor = 1.4
								trait = physician
							}
							modifier = {
								factor = 1.4
								trait = scholar
							}
							modifier = {
								factor = 1.2
								learning = 25
							}
							modifier = {
								factor = 1.2
								learning = 20
							}
							modifier = {
								factor = 1.2
								learning = 15
							}
							modifier = {
								factor = 1.2
								learning = 10
							}
							modifier = {
								factor = 0.8
								NOT = { learning = 10 }
							}
							modifier = {
								factor = 0.8
								is_dumb_trigger = yes
							}
							modifier = {
								factor = 1.2
								physician_good_trigger = yes
							}
							set_character_flag = medicine_identification_failure
						}
						20 = { #The pill is misidentified!
							modifier = {
								factor = 0.8
								trait = humble
							}
							modifier = {
								factor = 1.2
								trait = proud
							}
							modifier = {
								factor = 0.8
								is_smart_trigger = yes
							}
							modifier = {
								factor = 0.8
								learning = 25
							}
							modifier = {
								factor = 0.8
								learning = 20
							}
							modifier = {
								factor = 0.8
								learning = 15
							}
							modifier = {
								factor = 0.8
								learning = 10
							}
							modifier = {
								factor = 1.2
								NOT = { learning = 10 }
							}
							modifier = {
								factor = 1.2
								is_dumb_trigger = yes
							}
							modifier = {
								factor = 1.2
								physician_bad_trigger = yes
							}
							set_character_flag = medicine_misidentification
						}
					}
				}
			}
			character_event = { id = ATE_WWW_MEDICINE.3 days = 2 random = 2 }
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				attribute_diff = {
					character = event_target:court_physician
					attribute = learning
					value = 5
				}
			}
			modifier = {
				factor = 2
				attribute_diff = {
					character = event_target:court_physician
					attribute = learning
					value = 10
				}
			}
			modifier = {
				factor = 4
				trait = physician
			}
			modifier = {
				factor = 2
				trait = scholar
			}
			modifier = {
				factor = 1.5
				is_smart_trigger = yes
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.25
				trait = stubborn
			}
		}
	}

	#Identify the pill yourself first
	option = {
		name = EVTOPTB_ATE_WWW_MEDICINE_1
		tooltip_info = paranoid
		trigger = {
			NOR = {
				is_learned_trigger = yes
				learning = 12
			}
			trait = paranoid
			any_artifact = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_identified_as_antibiotics
					has_artifact_flag = atewww_pills_identified_as_antivirals
					has_artifact_flag = atewww_pills_identified_as_vitamins
					has_artifact_flag = atewww_pills_identified_as_viagra
					has_artifact_flag = atewww_pills_identified_as_antidepressants
					has_artifact_flag = atewww_pills_identified_as_painkillers
					has_artifact_flag = atewww_pills_identified_as_sugar
					has_artifact_flag = atewww_pills_cannot_be_identified
				}
			}
		}
		hidden_tooltip = {
			random_list = {
				60 = { #The pill is identified correctly
					modifier = {
						factor = 1.2
						is_smart_trigger = yes
					}
					modifier = {
						factor = 1.4
						trait = physician
					}
					modifier = {
						factor = 1.4
						trait = scholar
					}
					modifier = {
						factor = 1.2
						learning = 25
					}
					modifier = {
						factor = 1.2
						learning = 20
					}
					modifier = {
						factor = 1.2
						learning = 15
					}
					modifier = {
						factor = 1.2
						learning = 10
					}
					modifier = {
						factor = 0.8
						NOT = { learning = 10 }
					}
					modifier = {
						factor = 0.8
						is_dumb_trigger = yes
					}
					modifier = {
						factor = 1.2
						physician_good_trigger = yes
					}
					set_character_flag = medicine_identification_success
				}
				40 = { #The pill is not identified correctly
					modifier = {
						factor = 0.8
						is_smart_trigger = yes
					}
					modifier = {
						factor = 0.8
						learning = 25
					}
					modifier = {
						factor = 0.8
						learning = 20
					}
					modifier = {
						factor = 0.8
						learning = 15
					}
					modifier = {
						factor = 0.8
						learning = 10
					}
					modifier = {
						factor = 1.2
						NOT = { learning = 10 }
					}
					modifier = {
						factor = 1.2
						is_dumb_trigger = yes
					}
					modifier = {
						factor = 1.2
						physician_bad_trigger = yes
					}
					random_list = {
						80 = { #No idea what it does
							modifier = {
								factor = 1.2
								is_smart_trigger = yes
							}
							modifier = {
								factor = 1.4
								trait = physician
							}
							modifier = {
								factor = 1.4
								trait = scholar
							}
							modifier = {
								factor = 1.2
								learning = 25
							}
							modifier = {
								factor = 1.2
								learning = 20
							}
							modifier = {
								factor = 1.2
								learning = 15
							}
							modifier = {
								factor = 1.2
								learning = 10
							}
							modifier = {
								factor = 0.8
								NOT = { learning = 10 }
							}
							modifier = {
								factor = 0.8
								is_dumb_trigger = yes
							}
							modifier = {
								factor = 1.2
								physician_good_trigger = yes
							}
							set_character_flag = medicine_identification_failure
						}
						20 = { #The pill is misidentified!
							modifier = {
								factor = 0.8
								trait = humble
							}
							modifier = {
								factor = 1.2
								trait = proud
							}
							modifier = {
								factor = 0.8
								is_smart_trigger = yes
							}
							modifier = {
								factor = 0.8
								learning = 25
							}
							modifier = {
								factor = 0.8
								learning = 20
							}
							modifier = {
								factor = 0.8
								learning = 15
							}
							modifier = {
								factor = 0.8
								learning = 10
							}
							modifier = {
								factor = 1.2
								NOT = { learning = 10 }
							}
							modifier = {
								factor = 1.2
								is_dumb_trigger = yes
							}
							modifier = {
								factor = 1.2
								physician_bad_trigger = yes
							}
							set_character_flag = medicine_misidentification
						}
					}
				}
			}
			character_event = { id = ATE_WWW_MEDICINE.3 days = 2 random = 5 }
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				attribute_diff = {
					character = event_target:court_physician
					attribute = learning
					value = 5
				}
			}
			modifier = {
				factor = 2
				attribute_diff = {
					character = event_target:court_physician
					attribute = learning
					value = 10
				}
			}
			modifier = {
				factor = 4
				trait = physician
			}
			modifier = {
				factor = 2
				trait = scholar
			}
			modifier = {
				factor = 1.5
				is_smart_trigger = yes
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.25
				trait = stubborn
			}
		}
	}

	#Identify the pill first
	option = {
		name = EVTOPTC_ATE_WWW_MEDICINE_1
		trigger = {
			event_target:court_physician = { always = yes }
			any_artifact = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_identified_as_antibiotics
					has_artifact_flag = atewww_pills_identified_as_antivirals
					has_artifact_flag = atewww_pills_identified_as_vitamins
					has_artifact_flag = atewww_pills_identified_as_viagra
					has_artifact_flag = atewww_pills_identified_as_antidepressants
					has_artifact_flag = atewww_pills_identified_as_painkillers
					has_artifact_flag = atewww_pills_identified_as_sugar
					has_artifact_flag = atewww_pills_cannot_be_identified
				}
			}
		}
		hidden_tooltip = {
			random_list = {
				60 = { #The pill is identified correctly
					modifier = {
						factor = 1.2
						event_target:court_physician = { is_smart_trigger = yes }
					}
					modifier = {
						factor = 1.4
						event_target:court_physician = { trait = physician }
					}
					modifier = {
						factor = 1.4
						event_target:court_physician = { trait = scholar }
					}
					modifier = {
						factor = 1.2
						event_target:court_physician = { learning = 25 }
					}
					modifier = {
						factor = 1.2
						event_target:court_physician = { learning = 20 }
					}
					modifier = {
						factor = 1.2
						event_target:court_physician = { learning = 15 }
					}
					modifier = {
						factor = 1.2
						event_target:court_physician = { learning = 10 }
					}
					modifier = {
						factor = 0.8
						event_target:court_physician = { NOT = { learning = 10 } }
					}
					modifier = {
						factor = 0.8
						event_target:court_physician = { is_dumb_trigger = yes }
					}
					modifier = {
						factor = 1.2
						event_target:court_physician = { physician_good_trigger = yes }
					}
					ROOT = { set_character_flag = medicine_identification_success }
				}
				40 = { #The pill is not identified correctly
					modifier = {
						factor = 0.8
						event_target:court_physician = { is_smart_trigger = yes }
					}
					modifier = {
						factor = 0.8
						event_target:court_physician = { learning = 25 }
					}
					modifier = {
						factor = 0.8
						event_target:court_physician = { learning = 20 }
					}
					modifier = {
						factor = 0.8
						event_target:court_physician = { learning = 15 }
					}
					modifier = {
						factor = 0.8
						event_target:court_physician = { learning = 10 }
					}
					modifier = {
						factor = 1.2
						event_target:court_physician = { NOT = { learning = 10 } }
					}
					modifier = {
						factor = 1.2
						event_target:court_physician = { is_dumb_trigger = yes }
					}
					modifier = {
						factor = 1.2
						event_target:court_physician = { physician_bad_trigger = yes }
					}
					random_list = {
						80 = { #No idea what it does
							modifier = {
								factor = 1.2
								event_target:court_physician = { is_smart_trigger = yes }
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = { trait = physician }
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = { trait = scholar }
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = { learning = 25 }
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = { learning = 20 }
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = { learning = 15 }
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = { learning = 10 }
							}
							modifier = {
								factor = 0.8
								event_target:court_physician = { NOT = { learning = 10 } }
							}
							modifier = {
								factor = 0.8
								event_target:court_physician = { is_dumb_trigger = yes }
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = { physician_good_trigger = yes }
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = {
									opinion = { who = ROOT value = 0 }
								}
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = {
									opinion = { who = ROOT value = 25 }
								}
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = {
									opinion = { who = ROOT value = 50 }
								}
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = {
									opinion = { who = ROOT value = 75 }
								}
							}
							random_list = { #Do we tell the truth?
								70 = { #Yes
									modifier = {
										factor = 0.15
										event_target:court_physician = {
											trait = deceitful
										}
									}
									modifier = {
										factor = 0.75
										event_target:court_physician = {
											trait = proud
										}
									}
									modifier = {
										factor = 0.85
										event_target:court_physician = {
											trait = stubborn
										}
									}
									modifier = {
										factor = 1.5
										event_target:court_physician = {
											opinion = { who = ROOT value = 0 }
										}
									}
									modifier = {
										factor = 1.5
										event_target:court_physician = {
											opinion = { who = ROOT value = 25 }
										}
									}
									modifier = {
										factor = 1.5
										event_target:court_physician = {
											opinion = { who = ROOT value = 50 }
										}
									}
									modifier = {
										factor = 1.5
										event_target:court_physician = {
											opinion = { who = ROOT value = 75 }
										}
									}
									ROOT = { set_character_flag = medicine_identification_failure }
								}
								30 = { #No
									modifier = {
										factor = 0
										event_target:court_physician = {
											OR = {
												is_lover = ROOT
												is_friend = ROOT
											}
										}
									}
									modifier = {
										factor = 0.20
										event_target:court_physician = {
											trait = honest
										}
									}
									modifier = {
										factor = 0.75
										event_target:court_physician = {
											trait = humble
										}
									}
									modifier = {
										factor = 0.85
										event_target:court_physician = {
											trait = content
										}
									}
									modifier = {
										factor = 1.5
										event_target:court_physician = {
											NOT = { opinion = { who = ROOT value = 0 } }
										}
									}
									modifier = {
										factor = 1.5
										event_target:court_physician = {
											NOT = { opinion = { who = ROOT value = -25 } }
										}
									}
									modifier = {
										factor = 1.5
										event_target:court_physician = {
											NOT = { opinion = { who = ROOT value = -50 } }
										}
									}
									modifier = {
										factor = 1.5
										event_target:court_physician = {
											NOT = { opinion = { who = ROOT value = -75 } }
										}
									}
									ROOT = { set_character_flag = medicine_misidentification }
								}
							}
						}
						20 = { #The pill is misidentified!
							modifier = {
								factor = 0.8
								event_target:court_physician = { is_smart_trigger = yes }
							}
							modifier = {
								factor = 0.8
								event_target:court_physician = { learning = 25 }
							}
							modifier = {
								factor = 0.8
								event_target:court_physician = { learning = 20 }
							}
							modifier = {
								factor = 0.8
								event_target:court_physician = { learning = 15 }
							}
							modifier = {
								factor = 0.8
								event_target:court_physician = { learning = 10 }
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = { NOT = { learning = 10 } }
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = { is_dumb_trigger = yes }
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = { physician_bad_trigger = yes }
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = {
									NOT = { opinion = { who = ROOT value = 0 } }
								}
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = {
									NOT = { opinion = { who = ROOT value = -25 } }
								}
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = {
									NOT = { opinion = { who = ROOT value = -50 } }
								}
							}
							modifier = {
								factor = 1.2
								event_target:court_physician = {
									NOT = { opinion = { who = ROOT value = -75 } }
								}
							}
							ROOT = { set_character_flag = medicine_misidentification }
						}
					}
				}
			}
			set_character_flag = medicine_physician_identified
			character_event = { id = ATE_WWW_MEDICINE.3 days = 2 random = 5 }
		}
		ai_chance = {
			factor = 75
			modifier = {
				factor = 1.5
				attribute_diff = {
					character = ROOT
					attribute = learning
					value = 5
				}
			}
			modifier = {
				factor = 1.5
				attribute_diff = {
					character = ROOT
					attribute = learning
					value = 10
				}
			}
			modifier = {
				factor = 2
				event_target:court_physician = { trait = physician }
			}
			modifier = {
				factor = 1.5
				event_target:court_physician = { trait = scholar }
			}
			modifier = {
				factor = 1.25
				event_target:court_physician = { physician_good_trigger = yes }
			}
			modifier = {
				factor = 2
				trait = trusting
			}
			modifier = {
				factor = 1.5
				trait = content
			}
			modifier = {
				factor = 0
				trait = paranoid
			}
		}
	}

	#Maybe it's not the best idea... Exit.
	option = {
		name = EVTOPTD_ATE_WWW_MEDICINE_1
		ai_chance = {
			factor = 0
		}
	}
}

# Take pill menu
character_event = {
	id = ATE_WWW_MEDICINE.2
	desc = EVTDESC_ATE_WWW_MEDICINE_2
	picture = GFX_evt_court_physician
	is_triggered_only = yes
	border = GFX_event_normal_frame_religion
	
	#Just take it
	option = {
		name = EVTOPTA_ATE_WWW_MEDICINE_2
		trigger = {
			has_identified_medicine_to_take = yes
		}
		hidden_tooltip = {
			random_artifact = {
				limit = {
					artifact_type = atewww_pills
					OR = {
						AND = {
							has_artifact_flag = atewww_pills_identified_as_antibiotics
							ROOT = {
								OR = {
									trait = has_tuberculosis
									trait = has_typhoid_fever
									trait = has_typhus
									trait = has_bubonic_plague
									trait = syphilitic
									trait = dysentery
									trait = food_poisoning
									trait = pneumonic
									trait = ill
								}
							}
						}
						AND = {
							has_artifact_flag = atewww_pills_identified_as_antivirals
							ROOT = {
								OR = {
									trait = has_measles
									trait = has_small_pox
									trait = has_aztec_disease
									trait = flu
									trait = rabies
									trait = ill
								}
							}
						}
					}
				}
				save_event_target_as = taken_pill
			}
			hidden_tooltip = { add_character_modifier = { name = taken_medicine_recently days = 15 hidden = yes } }
			character_event = { id = ATE_WWW_MEDICINE.5 days = 1 random = 5 }
		}
	}

	#Just take painkillers
	option = {
		name = EVTOPTB_ATE_WWW_MEDICINE_2
		trigger = {
			any_artifact = {
				artifact_type = atewww_pills
				has_artifact_flag = atewww_pills_identified_as_painkillers
			}
		}
		hidden_tooltip = {
			random_artifact = {
				limit = {
					artifact_type = atewww_pills
					has_artifact_flag = atewww_pills_identified_as_painkillers
				}
				save_event_target_as = taken_pill
			}
			hidden_tooltip = { add_character_modifier = { name = taken_medicine_recently days = 15 hidden = yes } }
			character_event = { id = ATE_WWW_MEDICINE.6 days = 1 }
		}
	}

	#Just take a random one
	option = {
		name = EVTOPTC_ATE_WWW_MEDICINE_2
		trigger = {
			any_artifact = {
				artifact_type = atewww_pills
				has_artifact_flag = atewww_pills_cannot_be_identified
			}
			has_identified_medicine_to_take = no
		}
		hidden_tooltip = {
			random_artifact = {
				limit = {
					artifact_type = atewww_pills
					has_artifact_flag = atewww_pills_cannot_be_identified
				}
				save_event_target_as = taken_pill
			}
			hidden_tooltip = { add_character_modifier = { name = taken_medicine_recently days = 15 hidden = yes } }
			character_event = { id = ATE_WWW_MEDICINE.5 days = 1 random = 5 }
		}
	}

	#Maybe it's not the best idea... Exit.
	option = {
		name = EVTOPTD_ATE_WWW_MEDICINE_2
		ai_chance = {
			factor = 0
		}
	}
}

# identify pills
character_event = {
	id = ATE_WWW_MEDICINE.3
	desc = {
		trigger = { event_target:identified_pills = { has_artifact_flag = atewww_pills_cannot_be_identified } }
		text = EVTDESC_ATE_WWW_MEDICINE_3_CANT_IDENTIFY
	}
	desc = {
		trigger = { event_target:identified_pills = { has_artifact_flag = atewww_pills_identified_as_antibiotics } }
		text = EVTDESC_ATE_WWW_MEDICINE_3_ANTIBIOTICS
	}
	desc = {
		trigger = { event_target:identified_pills = { has_artifact_flag = atewww_pills_identified_as_antivirals } }
		text = EVTDESC_ATE_WWW_MEDICINE_3_ANTIVIRALS
	}
	desc = {
		trigger = { event_target:identified_pills = { has_artifact_flag = atewww_pills_identified_as_vitamins } }
		text = EVTDESC_ATE_WWW_MEDICINE_3_VITAMINS
	}
	desc = {
		trigger = { event_target:identified_pills = { has_artifact_flag = atewww_pills_identified_as_viagra } }
		text = EVTDESC_ATE_WWW_MEDICINE_3_VIAGRA
	}
	desc = {
		trigger = { event_target:identified_pills = { has_artifact_flag = atewww_pills_identified_as_antidepressants } }
		text = EVTDESC_ATE_WWW_MEDICINE_3_ANTIDEPRESSANTS
	}
	desc = {
		trigger = { event_target:identified_pills = { has_artifact_flag = atewww_pills_identified_as_painkillers } }
		text = EVTDESC_ATE_WWW_MEDICINE_3_PAINKILLERS
	}
	desc = {
		trigger = { event_target:identified_pills = { has_artifact_flag = atewww_pills_identified_as_sugar } }
		text = EVTDESC_ATE_WWW_MEDICINE_3_SUGAR
	}

	picture = GFX_evt_court_physician
	is_triggered_only = yes
	border = GFX_event_normal_frame_religion
	
	immediate = {
		if = {
			limit = { 
				has_character_flag = medicine_identification_success 
			}
			random_artifact = {
				limit = {
					artifact_type = atewww_pills
					NOR = {
						has_artifact_flag = atewww_pills_identified_as_antibiotics
						has_artifact_flag = atewww_pills_identified_as_antivirals
						has_artifact_flag = atewww_pills_identified_as_vitamins
						has_artifact_flag = atewww_pills_identified_as_viagra
						has_artifact_flag = atewww_pills_identified_as_antidepressants
						has_artifact_flag = atewww_pills_identified_as_painkillers
						has_artifact_flag = atewww_pills_identified_as_sugar
						has_artifact_flag = atewww_pills_cannot_be_identified
					}
				}
				if = {
					limit = { has_artifact_flag = atewww_pills_antibiotics }
					set_artifact_flag = atewww_pills_identified_as_antibiotics
					set_name = ATEWWW_PILL_ANTIBIOTICS
					set_description = ATEWWW_PILL_ANTIBIOTICS_desc
				}
				else_if = {
					limit = { has_artifact_flag = atewww_pills_antivirals }
					set_artifact_flag = atewww_pills_identified_as_antivirals
					set_name = ATEWWW_PILL_ANTIVIRALS
					set_description = ATEWWW_PILL_ANTIVIRALS_desc
				}
				else_if = {
					limit = { has_artifact_flag = atewww_pills_vitamins }
					set_artifact_flag = atewww_pills_identified_as_vitamins
					set_name = ATEWWW_PILL_VITAMINS
					set_description = ATEWWW_PILL_VITAMINS_desc
				}
				else_if = {
					limit = { has_artifact_flag = atewww_pills_viagra }
					set_artifact_flag = atewww_pills_identified_as_viagra
					set_name = ATEWWW_PILL_VIAGRA
					set_description = ATEWWW_PILL_VIAGRA_desc
				}
				else_if = {
					limit = { has_artifact_flag = atewww_pills_antidepressants }
					set_artifact_flag = atewww_pills_identified_as_antidepressants
					set_name = ATEWWW_PILL_ANTIDEPRESSANTS
					set_description = ATEWWW_PILL_ANTIDEPRESSANTS_desc
				}
				else_if = {
					limit = { has_artifact_flag = atewww_pills_painkillers }
					set_artifact_flag = atewww_pills_identified_as_painkillers
					set_name = ATEWWW_PILL_PAINKILLERS
					set_description = ATEWWW_PILL_PAINKILLERS_desc
				}
				else_if = {
					limit = { has_artifact_flag = atewww_pills_sugar }
					set_artifact_flag = atewww_pills_identified_as_sugar
				}
				save_event_target_as = identified_pills
			}
		}
		else_if = {
			limit = { has_character_flag = medicine_misidentification }
			random_artifact = {
				limit = {
					artifact_type = atewww_pills
					NOR = {
						has_artifact_flag = atewww_pills_identified_as_antibiotics
						has_artifact_flag = atewww_pills_identified_as_antivirals
						has_artifact_flag = atewww_pills_identified_as_vitamins
						has_artifact_flag = atewww_pills_identified_as_viagra
						has_artifact_flag = atewww_pills_identified_as_antidepressants
						has_artifact_flag = atewww_pills_identified_as_painkillers
						has_artifact_flag = atewww_pills_identified_as_sugar
						has_artifact_flag = atewww_pills_cannot_be_identified
					}
				}
				random_list = {
					20 = {	
						set_artifact_flag = atewww_pills_identified_as_antibiotics 
						set_name = ATEWWW_PILL_ANTIBIOTICS
						set_description = ATEWWW_PILL_ANTIBIOTICS_desc
					}
					8 = {	
						set_artifact_flag = atewww_pills_identified_as_antivirals 
						set_name = ATEWWW_PILL_ANTIVIRALS
						set_description = ATEWWW_PILL_ANTIVIRALS_desc
					}
					10 = {	
						set_artifact_flag = atewww_pills_identified_as_antidepressants 
						set_name = ATEWWW_PILL_ANTIDEPRESSANTS
						set_description = ATEWWW_PILL_ANTIDEPRESSANTS_desc
					}
					20 = {	
						set_artifact_flag = atewww_pills_identified_as_vitamins 
						set_name = ATEWWW_PILL_VITAMINS
						set_description = ATEWWW_PILL_VITAMINS_desc
					}
					20 = {	
						set_artifact_flag = atewww_pills_identified_as_painkillers 
						set_name = ATEWWW_PILL_PAINKILLERS
						set_description = ATEWWW_PILL_PAINKILLERS_desc
					}
					2 = {	
						set_artifact_flag = atewww_pills_identified_as_viagra
						set_name = ATEWWW_PILL_VIAGRA
						set_description = ATEWWW_PILL_VIAGRA_desc
					}
					20 = {	
						set_artifact_flag = atewww_pills_identified_as_sugar 
					}
				}
				save_event_target_as = identified_pills
			}
		}
		else = {
			random_artifact = {
				limit = {
					artifact_type = atewww_pills
					NOR = {
						has_artifact_flag = atewww_pills_identified_as_antibiotics
						has_artifact_flag = atewww_pills_identified_as_antivirals
						has_artifact_flag = atewww_pills_identified_as_vitamins
						has_artifact_flag = atewww_pills_identified_as_viagra
						has_artifact_flag = atewww_pills_identified_as_antidepressants
						has_artifact_flag = atewww_pills_identified_as_painkillers
						has_artifact_flag = atewww_pills_identified_as_sugar
						has_artifact_flag = atewww_pills_cannot_be_identified
					}
				}
				set_artifact_flag = atewww_pills_cannot_be_identified
				set_name = ATEWWW_PILL_UNKNOWN
				set_description = ATEWWW_PILL_UNKNOWN_desc
				save_event_target_as = identified_pills
			}
		}
		if = {
			limit = { has_character_flag = medicine_physician_identified }
			event_target:court_physician = {
				event_target:identified_pills = {
					save_persistent_event_target = {
						name = identified_by
						scope = PREV
					}
				}
			}
		}
		else = {
			event_target:identified_pills = {
				save_persistent_event_target = {
					name = identified_by
					scope = ROOT
				}
			}
		}
		clr_character_flag = medicine_identification_success
		clr_character_flag = medicine_misidentification
		clr_character_flag = medicine_identification_failure
	}

	option = {
		name = EVTOPTA_ATE_WWW_MEDICINE_3
		trigger = {
			NOT = { has_character_flag = medicine_physician_identified }
			any_artifact = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_identified_as_antibiotics
					has_artifact_flag = atewww_pills_identified_as_antivirals
					has_artifact_flag = atewww_pills_identified_as_vitamins
					has_artifact_flag = atewww_pills_identified_as_viagra
					has_artifact_flag = atewww_pills_identified_as_antidepressants
					has_artifact_flag = atewww_pills_identified_as_painkillers
					has_artifact_flag = atewww_pills_identified_as_sugar
					has_artifact_flag = atewww_pills_cannot_be_identified
				}
			}
		}
		if = {
			limit = {
				event_target:identified_pills = { has_artifact_flag = atewww_pills_identified_as_sugar }
			}
			event_target:identified_pills = {
				show_scope_change = no
				clear_persistent_event_target = identified_by
				destroy_artifact = yes
			}
		}
		character_event = { id = ATE_WWW_MEDICINE.1 }
	}

	option = {
		name = EVTOPTB_ATE_WWW_MEDICINE_3
		trigger = { NOT = { has_character_flag = medicine_physician_identified } }
		if = {
			limit = {
				event_target:identified_pills = { has_artifact_flag = atewww_pills_identified_as_sugar }
			}
			event_target:identified_pills = {
				show_scope_change = no
				clear_persistent_event_target = identified_by
				destroy_artifact = yes
			}
		}
	}

	option = {
		name = EVTOPTA_ATE_WWW_MEDICINE_3
		trigger = {
			has_character_flag = medicine_physician_identified
			any_artifact = {
				artifact_type = atewww_pills
				NOR = {
					has_artifact_flag = atewww_pills_identified_as_antibiotics
					has_artifact_flag = atewww_pills_identified_as_antivirals
					has_artifact_flag = atewww_pills_identified_as_vitamins
					has_artifact_flag = atewww_pills_identified_as_viagra
					has_artifact_flag = atewww_pills_identified_as_antidepressants
					has_artifact_flag = atewww_pills_identified_as_painkillers
					has_artifact_flag = atewww_pills_identified_as_sugar
					has_artifact_flag = atewww_pills_cannot_be_identified
				}
			}
		}
		event_target:court_physician = {
			show_portrait = yes
		}
		if = {
			limit = {
				event_target:identified_pills = { has_artifact_flag = atewww_pills_identified_as_sugar }
			}
			event_target:identified_pills = {
				show_scope_change = no
				clear_persistent_event_target = identified_by
				destroy_artifact = yes
			}
		}
		character_event = { id = ATE_WWW_MEDICINE.1 }
	}

	option = {
		name = EVTOPTB_ATE_WWW_MEDICINE_3
		trigger = { has_character_flag = medicine_physician_identified }
		event_target:court_physician = {
			show_portrait = yes
		}
		if = {
			limit = {
				event_target:identified_pills = { has_artifact_flag = atewww_pills_identified_as_sugar }
			}
			event_target:identified_pills = {
				show_scope_change = no
				clear_persistent_event_target = identified_by
				destroy_artifact = yes
			}
		}
	}

	after = {
		clr_character_flag = medicine_physician_identified
	}
}

# Took a pill
character_event = {
	id = ATE_WWW_MEDICINE.5
	desc = {
		trigger = {
			has_character_flag = was_sick
			character_disease_trigger = no
			NOT = { has_trait = ill }
		}
		text = EVTDESC_ATE_WWW_MEDICINE_5_SUCCESS
	}
	desc = {
		trigger = {
			has_character_flag = was_sick
			has_character_modifier = taken_painkillers
		}
		text = EVTDESC_ATE_WWW_MEDICINE_5_PAINKILLERS
	}
	desc = {
		trigger = {
			OR = {
				has_character_modifier = taken_viagra
				has_character_modifier = taken_viagra_female
			}
		}
		text = EVTDESC_ATE_WWW_MEDICINE_5_VIAGRA
	}
	desc = {
		trigger = {
			has_character_modifier = taken_vitamins
		}
		text = EVTDESC_ATE_WWW_MEDICINE_5_VITAMINS
	}
	desc = {
		trigger = {
			OR = {
				has_character_flag = removed_depressed
				has_character_flag = removed_lunatic
				has_character_flag = removed_possessed
			}
		}
		text = EVTDESC_ATE_WWW_MEDICINE_5_ANTIDEPRESSANT
	}
	desc = {
		trigger = {
			NOR = {
				AND = {
					has_character_flag = was_sick
					character_disease_trigger = no
					NOT = { has_trait = ill }
				}
				AND = {
					has_character_flag = was_sick
					has_character_modifier = taken_painkillers
				}
				has_character_modifier = taken_viagra
				has_character_modifier = taken_viagra_female
				has_character_modifier = taken_vitamins
				has_character_flag = removed_stressed
				has_character_flag = removed_depressed
				has_character_flag = removed_lunatic
				has_character_flag = removed_possessed
			}
		}
		text = EVTDESC_ATE_WWW_MEDICINE_5_FUMBLE
	}
	picture = GFX_evt_court_physician
	is_triggered_only = yes
	border = GFX_event_normal_frame_religion
	
	immediate = {
		event_target:taken_pill = {
			take_medicine_effect = yes
		}
	}

	option = {
		name = EVTOPTA_ATE_WWW_MEDICINE_5
		trigger = {
			NOT = { has_character_flag = side_effects }
			OR = {
				AND = {
					has_character_flag = was_sick
					character_disease_trigger = no
					NOT = { has_trait = ill }
				}
				AND = {
					has_character_flag = was_sick
					has_character_modifier = taken_painkillers
				}
				has_character_modifier = taken_viagra
				has_character_modifier = taken_viagra_female
				has_character_modifier = taken_vitamins
				has_character_flag = removed_stressed
				has_character_flag = removed_depressed
				has_character_flag = removed_lunatic
				has_character_flag = removed_possessed
			}
		}
		if = {
			limit = { has_character_flag = removed_stressed }
			remove_trait = stressed
		}
		if = {
			limit = { has_character_flag = removed_depressed }
			remove_trait = depressed
		}
		if = {
			limit = { has_character_flag = removed_lunatic }
			remove_trait = lunatic
		}
		if = {
			limit = { has_character_flag = removed_possessed }
			remove_trait = possessed
		}
	}

	option = {
		name = EVTOPTC_ATE_WWW_MEDICINE_5
		trigger = {
			OR = {
				AND = {
					has_character_flag = was_sick
					character_disease_trigger = no
					NOT = { has_trait = ill }
				}
				AND = {
					has_character_flag = was_sick
					has_character_modifier = taken_painkillers
				}
				has_character_modifier = taken_viagra
				has_character_modifier = taken_viagra_female
				has_character_modifier = taken_vitamins
				has_character_flag = removed_stressed
				has_character_flag = removed_depressed
				has_character_flag = removed_lunatic
				has_character_flag = removed_possessed
			}
			has_character_flag = side_effects
		}
		if = {
			limit = { has_character_flag = removed_stressed }
			remove_trait = stressed
		}
		if = {
			limit = { has_character_flag = removed_depressed }
			remove_trait = depressed
		}
		if = {
			limit = { has_character_flag = removed_lunatic }
			remove_trait = lunatic
		}
		if = {
			limit = { has_character_flag = removed_possessed }
			remove_trait = possessed
		}
		add_character_modifier = {
			name = pill_side_effects
			duration = 60
			stacking = yes
		}
	}

	option = {
		name = EVTOPTB_ATE_WWW_MEDICINE_5
		trigger = {
			NOR = {
				AND = {
					has_character_flag = was_sick
					character_disease_trigger = no
					NOT = { has_trait = ill }
				}
				AND = {
					has_character_flag = was_sick
					has_character_modifier = taken_painkillers
				}
				has_character_modifier = taken_viagra
				has_character_modifier = taken_viagra_female
				has_character_modifier = taken_vitamins
				has_character_flag = removed_stressed
				has_character_flag = removed_depressed
				has_character_flag = removed_lunatic
				has_character_flag = removed_possessed
			}
			has_character_flag = side_effects
		}
		if = {
			limit = { has_character_flag = removed_stressed }
			remove_trait = stressed
		}
		if = {
			limit = { has_character_flag = removed_depressed }
			remove_trait = depressed
		}
		if = {
			limit = { has_character_flag = removed_lunatic }
			remove_trait = lunatic
		}
		if = {
			limit = { has_character_flag = removed_possessed }
			remove_trait = possessed
		}
		add_character_modifier = {
			name = pill_side_effects
			duration = 60
			stacking = yes
		}
	}

	option = {
		name = EVTOPTD_ATE_WWW_MEDICINE_5
		trigger = {
			NOT = { has_character_flag = side_effects }
			NOR = {
				AND = {
					has_character_flag = was_sick
					character_disease_trigger = no
					NOT = { has_trait = ill }
				}
				AND = {
					has_character_flag = was_sick
					has_character_modifier = taken_painkillers
				}
				has_character_modifier = taken_viagra
				has_character_modifier = taken_viagra_female
				has_character_modifier = taken_vitamins
				has_character_flag = removed_stressed
				has_character_flag = removed_depressed
				has_character_flag = removed_lunatic
				has_character_flag = removed_possessed
			}
		}
	}

	after = {
		clr_character_flag = removed_stressed
		clr_character_flag = removed_depressed
		clr_character_flag = removed_lunatic
		clr_character_flag = removed_possessed
		clr_character_flag = was_sick
		clr_character_flag = side_effects
		clr_character_flag = pill_misidentified
	}
}